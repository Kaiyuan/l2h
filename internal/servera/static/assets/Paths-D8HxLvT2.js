import{s as k,a as u,b as $}from"./index-B-CRrfCq.js";import{f as C,g as B,r as p,o as P,c as y,d as o,a,u as s,s as f,w as d,h as U,b,e as E}from"./index-Bjsx5gTU.js";import{s as S}from"./index-CA6TXa3K.js";import{s as N}from"./index-DfmMe97U.js";import{a as g}from"./index-B9ygI19o.js";const D={class:"card"},M={class:"flex justify-between items-center mb-4"},R={key:0,class:"text-green-500 font-bold"},T={key:1,class:"text-gray-400"},j={class:"flex flex-column gap-4"},q={class:"flex flex-column gap-2"},A={class:"flex flex-column gap-2"},G={class:"flex flex-column gap-2"},O={__name:"Paths",setup(I){const i=C(),x=B(),h=p([]),v=p(!1),n=p(!1),m=p(!1),l=p({path:"",server_b_port:55055,password:""}),c=async()=>{v.value=!0;try{const r=await g.get("/api/paths");h.value=r.data||[]}catch{i.add({severity:"error",summary:"Error",detail:"无法加载路径列表",life:3e3})}finally{v.value=!1}},_=()=>{l.value={path:"",server_b_port:55055,password:""},n.value=!0},w=async()=>{if(!l.value.path){i.add({severity:"warn",summary:"Validation",detail:"路径不能为空",life:3e3});return}m.value=!0;try{await g.post("/api/paths",l.value),i.add({severity:"success",summary:"Success",detail:"路径添加成功",life:3e3}),n.value=!1,c()}catch(r){i.add({severity:"error",summary:"Error",detail:"添加失败: "+(r.response?.data?.message||r.message),life:3e3})}finally{m.value=!1}},V=r=>{x.require({message:"确定要删除这个路径吗?",header:"确认删除",icon:"pi pi-exclamation-triangle",accept:async()=>{try{await g.delete(`/api/paths/${r}`),i.add({severity:"success",summary:"Success",detail:"删除成功",life:3e3}),c()}catch{i.add({severity:"error",summary:"Error",detail:"删除失败",life:3e3})}}})};return P(()=>{c()}),(r,e)=>(b(),y("div",D,[o("div",M,[e[5]||(e[5]=o("h1",{class:"text-2xl font-bold"},"路径管理",-1)),a(s(f),{label:"添加路径",icon:"pi pi-plus",onClick:_})]),a(s(k),{value:h.value,loading:v.value,stripedRows:""},{empty:d(()=>[...e[6]||(e[6]=[E("暂无数据",-1)])]),default:d(()=>[a(s(u),{field:"id",header:"ID",sortable:""}),a(s(u),{field:"path",header:"路径",sortable:""}),a(s(u),{field:"server_b_port",header:"Server B 端口",sortable:""}),a(s(u),{header:"密码保护"},{body:d(t=>[t.data.password?(b(),y("span",R,"是")):(b(),y("span",T,"否"))]),_:1}),a(s(u),{header:"操作"},{body:d(t=>[a(s(f),{icon:"pi pi-trash",severity:"danger",text:"",rounded:"",onClick:L=>V(t.data.id)},null,8,["onClick"])]),_:1})]),_:1},8,["value","loading"]),a(s(U),{visible:n.value,"onUpdate:visible":e[4]||(e[4]=t=>n.value=t),header:"添加新路径",modal:"",style:{width:"400px"}},{footer:d(()=>[a(s(f),{label:"取消",text:"",onClick:e[3]||(e[3]=t=>n.value=!1)}),a(s(f),{label:"保存",onClick:w,loading:m.value},null,8,["loading"])]),default:d(()=>[o("div",j,[o("div",q,[e[7]||(e[7]=o("label",{for:"path"},"路径 (URL Path)",-1)),a(s(S),{id:"path",modelValue:l.value.path,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.path=t),placeholder:"e.g. my-service"},null,8,["modelValue"])]),o("div",A,[e[8]||(e[8]=o("label",{for:"port"},"Server B 端口",-1)),a(s($),{id:"port",modelValue:l.value.server_b_port,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.server_b_port=t),useGrouping:!1},null,8,["modelValue"])]),o("div",G,[e[9]||(e[9]=o("label",{for:"password"},"访问密码 (可选)",-1)),a(s(N),{id:"password",modelValue:l.value.password,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.password=t),feedback:!1,toggleMask:""},null,8,["modelValue"])])])]),_:1},8,["visible"])]))}};export{O as default};
