import{s as g}from"./index-BDZ89dOv.js";import{s as m}from"./index-CA6TXa3K.js";import{s as w}from"./index-DfmMe97U.js";import{f as y,r as n,o as V,c as b,d as a,a as o,w as x,u as d,s as _,b as k,e as U}from"./index-Bjsx5gTU.js";import{a as f}from"./index-B9ygI19o.js";const S={class:"card max-w-2xl mx-auto"},B={class:"flex flex-column gap-4"},E={class:"flex flex-column gap-4"},N={class:"flex flex-column gap-2"},$={class:"flex flex-column gap-2"},C={class:"flex flex-column gap-2"},M={class:"flex flex-column gap-2"},T={class:"flex justify-end"},A={__name:"Settings",setup(j){const r=y(),p=n(!1),u=n(!1),l=n({admin_path:"",username:"",password:"",email:""}),i=n(""),v=async()=>{p.value=!0;try{const s=await f.get("/api/settings");s.data&&(l.value={...s.data,password:""})}catch{r.add({severity:"error",summary:"Error",detail:"无法加载设置",life:3e3})}finally{p.value=!1}},c=async()=>{u.value=!0;try{const s={...l.value};if(i.value)s.password=i.value;else{const e=await f.get("/api/settings");s.password=e.data.password}await f.post("/api/settings",s),r.add({severity:"success",summary:"Success",detail:"设置已保存",life:3e3}),i.value="",v()}catch{r.add({severity:"error",summary:"Error",detail:"保存失败",life:3e3})}finally{u.value=!1}};return V(()=>{v()}),(s,e)=>(k(),b("div",S,[e[10]||(e[10]=a("h1",{class:"text-2xl font-bold mb-4"},"系统设置",-1)),a("div",B,[o(d(g),null,{title:x(()=>[...e[4]||(e[4]=[U("管理员账号",-1)])]),content:x(()=>[a("div",E,[a("div",N,[e[5]||(e[5]=a("label",{for:"username"},"用户名",-1)),o(d(m),{id:"username",modelValue:l.value.username,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.username=t)},null,8,["modelValue"])]),a("div",$,[e[6]||(e[6]=a("label",{for:"admin_path"},"管理页面路径 (URL)",-1)),o(d(m),{id:"admin_path",modelValue:l.value.admin_path,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.admin_path=t)},null,8,["modelValue"]),e[7]||(e[7]=a("small",{class:"text-gray-500"},"修改后需要通过新路径访问",-1))]),a("div",C,[e[8]||(e[8]=a("label",{for:"email"},"邮箱 (可选)",-1)),o(d(m),{id:"email",modelValue:l.value.email,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.email=t)},null,8,["modelValue"])]),a("div",M,[e[9]||(e[9]=a("label",{for:"password"},"新密码",-1)),o(d(w),{id:"password",modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=t=>i.value=t),feedback:!0,toggleMask:"",placeholder:"留空则保持不变"},null,8,["modelValue"])])])]),_:1}),a("div",T,[o(d(_),{label:"保存更改",onClick:c,loading:u.value},null,8,["loading"])])])]))}};export{A as default};
